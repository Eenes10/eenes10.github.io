<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trigonometrik Deƒüer Hesaplayƒ±cƒ± ‚Äî Eƒülenceli (v2.1)</title>
<link rel="manifest" href="/manifest.json">
<style>
  :root{
    --card-w:760px;
    --accent1:#6c74ff;
    --accent2:#34d399;
    --bg1:#e6f2ff;
    --bg2:#bfe0ff;
    --glass: rgba(255,255,255,0.88);
    --muted:#445a78;
    --shadow: 0 18px 40px rgba(13,38,76,0.12);

    /* spotlight vars */
    --spot-x: 50%;
    --spot-y: 50%;
    --spot-size: 220px;
    --spot-intensity: 1;
  }

  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Arial,Helvetica,sans-serif}
  html,body{height:100%;margin:0}
  body{
    background: linear-gradient(160deg,var(--bg1),var(--bg2));
    display:flex;align-items:center;justify-content:center;padding:28px;color:#07204a;overflow:hidden;
    transition:background .25s ease,color .25s ease;
  }

  /* animated grid background */
  .bg-grid{
    position:fixed;inset:0;z-index:0;pointer-events:none;opacity:0.28;
    background-image: repeating-linear-gradient(0deg, rgba(10,20,40,0.04) 0 1px, transparent 1px 28px),
                      repeating-linear-gradient(90deg, rgba(10,20,40,0.03) 0 1px, transparent 1px 28px);
    background-size: 100% 100%;
    animation: gridPan 40s linear infinite;
    mix-blend-mode:multiply;
    transition:opacity .3s ease, filter .3s ease;
  }
  @keyframes gridPan{from{background-position:0 0}to{background-position:400px 400px}}

  /* improved spotlight: multi-layer radial gradients, reactive via CSS vars */
  .spot {
    position:fixed; left:0; top:0; width:100%; height:100%;
    pointer-events:none; mix-blend-mode:screen; z-index:1;
    transition: opacity .25s ease, filter .24s ease, transform .24s ease;
    opacity: 1;
    filter: blur(10px) saturate(120%);
    background:
      radial-gradient(circle var(--spot-size) at var(--spot-x) var(--spot-y),
        rgba(255,255,255,calc(0.45 * var(--spot-intensity))) 0%,
        rgba(255,255,255,calc(0.20 * var(--spot-intensity))) 25%,
        rgba(160,190,255,calc(0.06 * var(--spot-intensity))) 55%,
        transparent 75%),
      radial-gradient(circle calc(var(--spot-size) * 0.5) at calc(var(--spot-x) - 6%) calc(var(--spot-y) - 4%),
        rgba(255,255,255,calc(0.22 * var(--spot-intensity))) 0%,
        rgba(255,255,255,0) 45%);
    will-change: background-position, opacity;
  }
<!-- Instagram Butonu -->
<a href="https://www.instagram.com/enesyavuz07/" target="_blank" style="
  position: fixed;
  bottom: 16px;
  right: 16px;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  text-decoration: none;
  transition: transform 0.2s;
" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="width:22px;height:22px;fill:white;">
    <path d="M349.33 69.33H162.67C114.95 69.33 77.33 106.95 77.33 154.67v186.67c0 47.72 37.62 85.34 85.34 85.34h186.67c47.72 0 85.34-37.62 85.34-85.34V154.67c0-47.72-37.62-85.34-85.34-85.34zM256 370.67c-63.78 0-115.67-51.89-115.67-115.67S192.22 139.33 256 139.33 371.67 191.22 371.67 256 319.78 370.67 256 370.67zm124.67-189.34c-14.14 0-25.67-11.53-25.67-25.67s11.53-25.67 25.67-25.67 25.67 11.53 25.67 25.67-11.53 25.67-25.67 25.67z"/>
    <circle cx="256" cy="256" r="76"/>
  </svg>
</a>

</body>
</html>
  /* dark mode selectors target html.dark so toggling documentElement.classList works */
  .dark body{
    background: linear-gradient(160deg,#071428,#0b2a41);
    color: #cfe9ff;
  }
  .dark .bg-grid{ opacity:0.12; filter:brightness(0.8) }
  .dark .container{ background: rgba(6,12,30,0.72); box-shadow: 0 18px 40px rgba(0,0,0,0.6); }
  .dark .btn{ background:#071428; color:#cfe9ff; box-shadow:0 6px 18px rgba(2,6,23,0.4); }
  .dark .btn.active{ box-shadow:0 20px 50px rgba(0,0,0,0.6); }
  .dark .plot-card{ background:linear-gradient(180deg,#071428,#042033); }
  .dark .result{ background: linear-gradient(180deg,#071a2b,#042033); border:1px solid rgba(255,255,255,0.03); }
  .dark .icon path{ stroke: #cfe9ff; }

  .container{position:relative;z-index:2;width:var(--card-w);padding:18px;border-radius:14px;background:var(--glass);backdrop-filter:blur(8px) saturate(120%);box-shadow:var(--shadow);transition:background .24s ease, box-shadow .24s ease}
  header{display:flex;align-items:center;gap:12px;justify-content:space-between}
  h1{font-size:18px;margin:0;font-weight:800}
  .controls{display:flex;gap:8px;align-items:center}

  /* function and unit row */
  .func-row{display:flex;gap:8px;margin:12px 0}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:9px 12px;border-radius:10px;border:0;background:#f6f9ff;cursor:pointer;font-weight:700;box-shadow:0 6px 18px rgba(10,20,40,0.05);transition:transform .14s,box-shadow .14s,background .14s,opacity .18s}
  .btn:hover{transform:translateY(-3px)}
  .btn.active{background:linear-gradient(90deg,var(--accent1),#8a90ff);color:white;box-shadow:0 14px 40px rgba(106,115,255,0.16)}

  .field{display:flex;gap:8px;align-items:center;margin-top:8px}
  input[type=number]{padding:10px 12px;border-radius:10px;border:1px solid #d6e7ff;width:140px}
  .unit-toggle{display:flex;gap:6px}
  .unit-toggle .btn{padding:8px 10px;font-weight:700}

  /* layout: left plot, right controls */
  .main{display:grid;grid-template-columns:1fr 320px;gap:12px;align-items:start}
  .plot-card{border-radius:12px;padding:12px;background:linear-gradient(180deg,#fff,#f8fbff);box-shadow:inset 0 1px 0 rgba(255,255,255,0.6);transition:background .25s}
  canvas{width:100%;height:240px;border-radius:8px;background:linear-gradient(180deg,#fbfdff,#eef8ff);display:block}

  .side{display:flex;flex-direction:column;gap:10px}
  .actions{display:flex;gap:8px}
  .calc-btn{flex:1;padding:12px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent2),#0fb07b);color:white;font-weight:800;cursor:pointer}

  .result{border-radius:12px;padding:12px;background:linear-gradient(180deg,#fff,#f7fbff);min-height:72px;display:flex;flex-direction:column;gap:6px;transition:background .2s}
  .exact{font-weight:800;color:#0b2b52;font-size:15px}
  .approx{color:#556b86;font-size:13px}

  /* micro animations */
  .pulse{animation:pulse 1.2s ease-in-out}
  @keyframes pulse{0%{transform:scale(1);box-shadow:0 0 0 rgba(100,116,255,0.12)}50%{transform:scale(1.02);box-shadow:0 18px 40px rgba(100,116,255,0.08)}100%{transform:scale(1);box-shadow:0 0 0 rgba(100,116,255,0)}}

  /* icons */
  .icon{width:18px;height:18px;display:inline-block}

  /* responsive */
  @media (max-width:860px){:root{--card-w:94vw}.main{grid-template-columns:1fr}.plot-card canvas{height:200px}}
</style>
</head>
<body>
  <div class="bg-grid" id="bgGrid"></div>
  <div class="spot" id="spot"></div>

  <div class="container">
    <header>
      <div style="display:flex;align-items:center;gap:12px">
        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2v20M2 12h20" stroke="#6c74ff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <h1>Trigonometrik Deƒüer Hesaplayƒ±cƒ±</h1>
      </div>
      <div class="controls">
        <button id="themeToggle" class="btn" title="Karanlƒ±k / A√ßƒ±k">üåô Tema</button>
        <button id="installBtn" class="btn" style="display:none">‚¨áÔ∏è Uygulamayƒ± Ekle</button>
      </div>
    </header>

    <div class="func-row" id="funcRow">
      <button class="btn active" data-f="sin">sin</button>
      <button class="btn" data-f="cos">cos</button>
      <button class="btn" data-f="tan">tan</button>
      <button class="btn" data-f="cosec">cosec</button>
      <button class="btn" data-f="sec">sec</button>
      <button class="btn" data-f="cot">cot</button>
    </div>

    <div class="main">
      <div class="plot-card">
        <canvas id="plotCanvas" width="800" height="320" aria-label="Trigonometrik fonksiyon grafiƒüi"></canvas>
        <div style="display:flex;align-items:center;gap:8px;margin-top:10px">
          <label style="font-weight:700">A√ßƒ±:</label>
          <input id="angle" type="number" inputmode="decimal" value="30" />
          <div class="unit-toggle">
            <button id="degBtn" class="btn active">¬∞</button>
            <button id="radBtn" class="btn">rad</button>
          </div>
        </div>
        <input id="angleRange" type="range" min="-360" max="360" step="0.1" value="30" style="width:100%;margin-top:10px">
      </div>

      <div class="side">
        <div style="display:flex;gap:8px">
          <button id="calcBtn" class="calc-btn">Hesapla ‚ú®</button>
          <button id="histBtn" class="btn">üìú</button>
        </div>

        <div class="result" id="result">
          <div class="exact" id="exact">‚Äî</div>
          <div class="approx" id="approx">Sonu√ß burada g√∂r√ºnecek.</div>
        </div>

        <details>
          <summary style="cursor:pointer;padding:8px 10px;border-radius:10px;background:#fff;">Form√ºller</summary>
          <div style="padding:8px 12px">sin¬≤x + cos¬≤x = 1<br>1 + tan¬≤x = sec¬≤x<br>sin(Œ±¬±Œ≤)=sinŒ±cosŒ≤¬±cosŒ±sinŒ≤</div>
        </details>
      </div>
    </div>
  </div>

<script>
// === small utility expressions parser (same as your original) ===
function parseExactStringToNumber(s){
  if(!s || s==='‚Äî') return NaN;
  if(s === 'Tanƒ±msƒ±z') return NaN;
  s = s.replace(/\s+/g,'');
  let numerator = s; let denom = 1;
  if(s.includes('/')){
    const parts = s.split('/');
    numerator = parts.slice(0,parts.length-1).join('/');
    denom = Number(parts[parts.length-1]);
    if(Number.isNaN(denom)) denom = parseTerm(parts[parts.length-1]);
  }
  if(numerator.startsWith('(') && numerator.endsWith(')')) numerator = numerator.slice(1,-1);
  const tokens = numerator.match(/[+-]?[^+-]+/g) || [];
  let total = 0; for(let token of tokens) total += parseTerm(token);
  return total / denom;
}
function parseTerm(token){
  token = token.trim(); if(token === '') return 0; if(token[0] === '+') token = token.slice(1);
  if(token.includes('‚àö')){
    token = token.replace(/\(/g,'').replace(/\)/g,'');
    let sign = 1; if(token[0] === '-'){ sign=-1; token=token.slice(1);} if(token[0]==='+') token=token.slice(1);
    const m = token.match(/^(\d*\.?\d*)?‚àö(\d+(?:\.\d+)?)$/);
    if(m){ const coeff = m[1] ? Number(m[1]) : 1; const rad = Number(m[2]); return sign * coeff * Math.sqrt(rad); }
  }
  const n = Number(token); if(!Number.isNaN(n)) return n;
  const parts = token.match(/[+-]?[^+-]+/g);
  if(parts && parts.length>1){ let s=0; for(const p of parts) s+=parseTerm(p); return s; }
  return 0;
}

// === exact map (trimmed for brevity) ===
const exactValues = { sin:{0:'0',15:'(‚àö6-‚àö2)/4',30:'1/2',45:'‚àö2/2',60:'‚àö3/2',90:'1',180:'0'}, cos:{0:'1',30:'‚àö3/2',45:'‚àö2/2',60:'1/2',90:'0',180:'-1'}, tan:{0:'0',30:'1/‚àö3',45:'1',60:'‚àö3',90:'Tanƒ±msƒ±z'} };

// DOM refs
const funcButtons = Array.from(document.querySelectorAll('.func-row .btn'));
const angleInput = document.getElementById('angle');
const angleRange = document.getElementById('angleRange');
const degBtn = document.getElementById('degBtn');
const radBtn = document.getElementById('radBtn');
const calcBtn = document.getElementById('calcBtn');
const exactEl = document.getElementById('exact');
const approxEl = document.getElementById('approx');
const plotCanvas = document.getElementById('plotCanvas');
const ctx = plotCanvas.getContext('2d');
let currentFunc = 'sin'; let unit='deg'; let history = JSON.parse(localStorage.getItem('trig_history_v2')||'[]');

// set active func
funcButtons.forEach(b=>b.addEventListener('click', ()=>{ funcButtons.forEach(x=>x.classList.remove('active')); b.classList.add('active'); currentFunc = b.dataset.f; drawPlot(); }));

degBtn.addEventListener('click', ()=>{ unit='deg'; degBtn.classList.add('active'); radBtn.classList.remove('active'); syncInputs(); drawPlot(); });
radBtn.addEventListener('click', ()=>{ unit='rad'; radBtn.classList.add('active'); degBtn.classList.remove('active'); syncInputs(); drawPlot(); });

angleInput.addEventListener('input', ()=>{ syncRange(); drawPlot(); });
angleRange.addEventListener('input', ()=>{ syncInputs(true); drawPlot(); });

function syncRange(){ const val = angleInput.value || 0; angleRange.value = (unit==='deg')?val: (Number(val)*(180/Math.PI)); }
function syncInputs(fromRange){ if(fromRange){ const v = Number(angleRange.value); angleInput.value = (unit==='deg')? v : (v*Math.PI/180); } else { syncRange(); } }

// compute trig
function computeTrigValue(fn, rad){ switch(fn){ case 'sin': return Math.sin(rad); case 'cos': return Math.cos(rad); case 'tan': return Math.tan(rad); case 'cosec': return 1/Math.sin(rad); case 'sec': return 1/Math.cos(rad); case 'cot': return 1/Math.tan(rad); } }

function showResult(exactStr, approxNum){ exactEl.classList.remove('pulse'); approxEl.classList.remove('pulse'); void exactEl.offsetWidth; exactEl.textContent = exactStr || ''; approxEl.textContent = (approxNum===null)? 'Tanƒ±msƒ±z' : (typeof approxNum==='number'? approxNum.toFixed(6): approxNum); exactEl.classList.add('pulse'); approxEl.classList.add('pulse'); }

calcBtn.addEventListener('click', ()=>{
  const raw = angleInput.value.trim(); if(raw===''){ showResult('', 'L√ºtfen a√ßƒ± girin.'); return; }
  const parsed = Number(raw); if(Number.isNaN(parsed)){ showResult('', 'Ge√ßerli sayƒ± girin.'); return; }
  let degForLookup = (unit==='deg')? parsed : (parsed*180/Math.PI);
  degForLookup = Math.round(degForLookup*10000)/10000;
  const intDeg = Math.round(degForLookup); const isIntegerAngle = Math.abs(intDeg - degForLookup) < 1e-9;
  const fnMap = exactValues[currentFunc];
  if(isIntegerAngle && fnMap && fnMap[intDeg] !== undefined){ const exact = fnMap[intDeg]; const approx = parseExactStringToNumber(exact); showResult(exact, approx); pushHistory(`${currentFunc} ${intDeg}¬∞ = ${approx.toFixed(6)}`); return; }
  const angleRad = (unit==='deg')? parsed*Math.PI/180 : parsed;
  const val = computeTrigValue(currentFunc, angleRad);
  if(!isFinite(val)){ showResult('', 'Tanƒ±msƒ±z'); pushHistory(`${currentFunc} ${parsed} ${unit} = Tanƒ±msƒ±z`); return; }
  showResult('', val); pushHistory(`${currentFunc} ${parsed} ${unit} = ${val.toFixed(6)}`);
});

function pushHistory(text){ history = history||[]; history.push(text); if(history.length>80) history.shift(); localStorage.setItem('trig_history_v2', JSON.stringify(history)); }
document.getElementById('histBtn').addEventListener('click', ()=>{ alert(history.slice().reverse().join('\n')||'Hen√ºz ge√ßmi≈ü yok'); });

// spotlight follow & improved fade behaviour
const spot = document.getElementById('spot');
const bgGrid = document.getElementById('bgGrid');
let spotFadeTimeout = null;
function setSpot(x, y, sizeRatio=1, intensity=1){
  // set CSS vars (use percentages for positions)
  const px = Math.round(x);
  const py = Math.round(y);
  spot.style.setProperty('--spot-x', px + 'px');
  spot.style.setProperty('--spot-y', py + 'px');
  // responsive size (base var * ratio)
  const base = Math.max(140, Math.min(420, window.innerWidth * 0.18));
  spot.style.setProperty('--spot-size', (base * sizeRatio) + 'px');
  spot.style.setProperty('--spot-intensity', intensity);
  // gentle scale to mimic glow movement
  spot.style.transform = 'translateZ(0) scale(' + (1 + (0.015 * sizeRatio)) + ')';
  spot.style.opacity = 1;
  bgGrid.style.opacity = 0.28; // keep grid visible normally
  if(spotFadeTimeout) clearTimeout(spotFadeTimeout);
  spotFadeTimeout = setTimeout(()=>{ // slowly reduce intensity when mouse stops
    spot.style.setProperty('--spot-intensity', 0.6);
  }, 220);
}

document.addEventListener('mousemove', (e)=>{
  // map pointer to viewport and set size/intensity based on speed
  setSpot(e.clientX, e.clientY, 1.05, 1.15);
});

// when pointer leaves window, fade out
document.addEventListener('mouseout', (e)=>{
  // if leaving to outside of viewport
  if(!e.relatedTarget){
    spot.style.opacity = 0.28;
    bgGrid.style.opacity = 0.14;
  }
});

// touch support: center-ish, lower intensity
document.addEventListener('touchstart', (e)=>{
  const t = e.touches[0];
  setSpot(t.clientX, t.clientY, 0.9, 0.8);
});
document.addEventListener('touchmove', (e)=>{
  const t = e.touches[0];
  setSpot(t.clientX, t.clientY, 0.95, 0.9);
});

// theme toggle (persist) - fixed to toggle class on <html>
const themeToggle = document.getElementById('themeToggle');
(function initTheme(){
  const stored = localStorage.getItem('trig_theme');
  const isDark = (stored === 'dark') || (stored === null && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
  if(isDark) document.documentElement.classList.add('dark');
  updateThemeButtonIcon();
  themeToggle.addEventListener('click', ()=>{
    document.documentElement.classList.toggle('dark');
    const nowDark = document.documentElement.classList.contains('dark');
    localStorage.setItem('trig_theme', nowDark ? 'dark' : 'light');
    updateThemeButtonIcon();
  });
})();
function updateThemeButtonIcon(){
  const isDarkNow = document.documentElement.classList.contains('dark');
  themeToggle.textContent = (isDarkNow ? '‚òÄÔ∏è A√ßƒ±k' : 'üåô Karanlƒ±k');
}

// install prompt handling
let deferredPrompt; const installBtn = document.getElementById('installBtn'); window.addEventListener('beforeinstallprompt', (e)=>{ e.preventDefault(); deferredPrompt = e; installBtn.style.display = 'inline-flex'; }); installBtn.addEventListener('click', async ()=>{ if(!deferredPrompt) return; deferredPrompt.prompt(); const choice = await deferredPrompt.userChoice; deferredPrompt = null; installBtn.style.display='none'; });

// draw plot
function drawPlot(){ const w = plotCanvas.width = plotCanvas.clientWidth*devicePixelRatio; const h = plotCanvas.height = 240*devicePixelRatio; ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0); ctx.clearRect(0,0,plotCanvas.clientWidth,240);
  const padding = 32; const W = plotCanvas.clientWidth - padding*2; const H = 200; const cx = padding; const cy = padding + H/2;
  // background grid
  ctx.strokeStyle = 'rgba(10,20,40,0.06)'; ctx.lineWidth = 1; for(let x=0;x<=W;x+=20){ ctx.beginPath(); ctx.moveTo(cx+x, padding); ctx.lineTo(cx+x, padding+H); ctx.stroke(); }
  for(let y=0;y<=H;y+=20){ ctx.beginPath(); ctx.moveTo(cx, padding+y); ctx.lineTo(cx+W, padding+y); ctx.stroke(); }
  // axes
  ctx.strokeStyle = 'rgba(10,20,40,0.18)'; ctx.lineWidth = 1.2; ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(cx+W, cy); ctx.stroke(); ctx.beginPath(); ctx.moveTo(cx+W/2, padding); ctx.lineTo(cx+W/2, padding+H); ctx.stroke();
  // plot function (x domain -2œÄ..2œÄ)
  const domainMin = -2*Math.PI; const domainMax = 2*Math.PI; function xToPx(x){ return cx + ( (x - domainMin)/(domainMax-domainMin) ) * W; }
  function yToPx(y){ const scale = H/2; return cy - y*scale; }
  ctx.beginPath(); ctx.lineWidth = 2; ctx.strokeStyle = 'rgba(108,116,255,0.92)';
  const steps = 800; for(let i=0;i<=steps;i++){ const t = domainMin + (i/steps)*(domainMax-domainMin); let y = 0; try{ y = computeTrigValue(currentFunc, t); }catch(e){ y = NaN; }
    if(!isFinite(y)) { ctx.moveTo(xToPx(t), yToPx(0)); continue; }
    const px = xToPx(t), py = yToPx(Math.max(-3,Math.min(3,y))); if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
  } ctx.stroke();
  // draw marker for current angle
  const angleVal = Number(angleInput.value) || 0; const angleRad = (unit==='deg') ? angleVal*Math.PI/180 : angleVal; const markerX = xToPx(angleRad);
  ctx.fillStyle = '#ff6b6b'; ctx.beginPath(); ctx.arc(markerX, yToPx(Math.max(-3,Math.min(3, computeTrigValue(currentFunc, angleRad)))), 6,0,Math.PI*2); ctx.fill();
  // labels
  ctx.fillStyle = '#274060'; ctx.font = '12px Inter, system-ui'; ctx.fillText('-2œÄ', cx+2, padding+H+14); ctx.fillText('0', cx+W/2-6, padding+H+14); ctx.fillText('2œÄ', cx+W-22, padding+H+14);
}

// initial draw
drawPlot(); window.addEventListener('resize', ()=> drawPlot());

// PWA: register service worker if available
if('serviceWorker' in navigator){ navigator.serviceWorker.register('/service-worker.js').catch(()=>{}); }

</script>
</body>
</html>

